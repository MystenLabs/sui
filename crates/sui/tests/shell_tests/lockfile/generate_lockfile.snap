---
source: crates/sui/tests/shell_tests.rs
---
----- script -----
# Copyright (c) Mysten Labs, Inc.
# SPDX-License-Identifier: Apache-2.0

echo "Run a build and verify that the correct lockfile is produced"
sui move --client.config $CONFIG build -p a

echo "Lockfile"
echo "==="
cat a/Move.lock
cp a/Move.lock a/Move.lock.tmp
echo "==="

echo "Rebuild and ensure that the lockfile hasn't changed"
sui move --client.config $CONFIG build -p a

echo "Diff"
echo "==="
diff a/Move.lock a/Move.lock.tmp
echo "==="

----- results -----
success: true
exit_code: 0
----- stdout -----
Run a build and verify that the correct lockfile is produced
Lockfile
===
# Generated by move; do not edit
# This file should be checked in.

[move]
version = 4

[pinned.testnet.MoveStdlib]
source = { local = "../move-stdlib" }
use_environment = "testnet"
manifest_digest = "C4FE4C91DE74CBF223B2E380AE40F592177D21870DC2D7EB6227D2D694E05363"
deps = {}

[pinned.testnet.a]
source = { root = true }
use_environment = "testnet"
manifest_digest = "BEB5933927C5A6767CDA1D9B045B9CB3BAB95B0F2C7CF87A36AA9A68E2C53C31"
deps = { std = "MoveStdlib" }
===
Rebuild and ensure that the lockfile hasn't changed
Diff
===
===

----- stderr -----
INCLUDING DEPENDENCY MoveStdlib
BUILDING a
INCLUDING DEPENDENCY MoveStdlib
BUILDING a
