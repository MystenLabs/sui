---
title: Sui Trace Analysis
description: Use the Sui CLI to analyze transaction traces.
---

[Replaying a transaction](./replay.mdx) generates a trace file that contains detailed information about the execution of the transaction (such as gas usage, functions called, instructions executed and more). You can use the Sui CLI to analyze these trace files and extract useful insights.

Currently the only supported analysis is to produce a gas profile for the transaction that was traced with the replay command, but more analyses are planned.

### Profile a transaction

Use the `sui analyze-trace -p <PATH_TO_TRACE_FILE> gas-profile` command to analyze a trace for a transaction and produce a gas profile. 

The command outputs a profile to the current working directory in the format `gas_profile_{TRACE_FILE_NAME}.json`. You can also supply an optional `--output/-o` flag to the `analyze-trace` command to specify a different output directory for the profile. Use [speedscope](https://www.speedscope.app/) to display the profile that was generated.

To install speedscope run

```sh
$ npm install -g speedscope
```

To open a profile in speedscope run

```sh
$ speedscope <PATH/PROFILE-OUTPUT-FILE>
```

When looking at the profile in speedscope, there are three different views available from the top left menu: **Timer Order**,
**Left Heavy**, and **Sandwich**. In each view, each bar's vertical width corresponds to the percentage of gas consumption incurred by the function,
and you can hover your mouse over a bar or click a bar to see the computation units accrued by the function invocation. The transaction's total computation units, along with the storage computation units, are multiplied by the gas price to determine the gas cost of the transaction based on a tier system.

**Time Order** shows the callstack of function invocations from left to right in the order
of invocation, while **Left Heavy** combines repeated sequences of nested invocations into a single combined call stack. **Left Heavy** 
displays these sequences from left to right by total incurred gas consumption per combined call stack. This is useful when there have
been hundreds of repeated calls to the same function to quickly observe the total gas consumption over all calls to that function.
In both these views, you can click the top section and drag to zoom in and out over different sections of the profile.

**Sandwich** view shows a list of discrete values that correspond to gas consumption per function, with **Total** showing
gas cost incurred in all the functions called by the function, and **Self** showing the gas cost done by only the given function.

Observing a transaction's gas consumption provides useful insight of expected gas cost usage of a smart contract.
When developing a smart contract, you can [run a local network](../../guides/developer/getting-started/local-network.mdx) and publish the package to the local network. Then create a transaction that calls
your published smart contract, and finally run the profiler on the transaction to see a breakdown of the gas cost.
