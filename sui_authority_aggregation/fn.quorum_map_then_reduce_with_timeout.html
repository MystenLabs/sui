<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This function takes an initial state, than executes an asynchronous function (FMap) for each authority, and folds the results as they become available into the state using an async function (FReduce)."><title>quorum_map_then_reduce_with_timeout in sui_authority_aggregation - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="sui_authority_aggregation" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0 (ded5c06cf 2025-12-08)" data-channel="1.92.0" data-search-js="search-d69d8955.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">quorum_map_then_reduce_with_timeout</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../sui_authority_aggregation/index.html">sui_<wbr>authority_<wbr>aggregation</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="index.html">sui_authority_aggregation</a></div><h1>Function <span class="fn">quorum_<wbr>map_<wbr>then_<wbr>reduce_<wbr>with_<wbr>timeout</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/sui_authority_aggregation/lib.rs.html#183-230">Source</a> </span></div><pre class="rust item-decl"><code>pub async fn quorum_map_then_reduce_with_timeout&lt;'a, C, K, Client: 'a, S: 'a, V: 'a, R: 'a, E, FMap, FReduce&gt;(
    committee: <a class="struct" href="https://doc.rust-lang.org/1.92.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;C&gt;,
    authority_clients: <a class="struct" href="https://doc.rust-lang.org/1.92.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.92.0/alloc/collections/btree/map/struct.BTreeMap.html" title="struct alloc::collections::btree::map::BTreeMap">BTreeMap</a>&lt;K, <a class="struct" href="https://doc.rust-lang.org/1.92.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;Client&gt;&gt;&gt;,
    initial_state: S,
    map_each_authority: FMap,
    reduce_result: FReduce,
    initial_timeout: <a class="struct" href="https://doc.rust-lang.org/1.92.0/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>,
) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.92.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;(R, FuturesUnordered&lt;impl <a class="trait" href="https://doc.rust-lang.org/1.92.0/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = (K, <a class="enum" href="https://doc.rust-lang.org/1.92.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;V, E&gt;)&gt; + 'a&gt;), S&gt;<div class="where">where
    K: <a class="trait" href="https://doc.rust-lang.org/1.92.0/core/cmp/trait.Ord.html" title="trait core::cmp::Ord">Ord</a> + ConciseableName&lt;'a&gt; + <a class="trait" href="https://doc.rust-lang.org/1.92.0/core/clone/trait.Clone.html" title="trait core::clone::Clone">Clone</a> + 'a,
    C: CommitteeTrait&lt;K&gt;,
    FMap: <a class="trait" href="https://doc.rust-lang.org/1.92.0/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(K, <a class="struct" href="https://doc.rust-lang.org/1.92.0/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;Client&gt;) -&gt; <a class="type" href="type.AsyncResult.html" title="type sui_authority_aggregation::AsyncResult">AsyncResult</a>&lt;'a, V, E&gt; + <a class="trait" href="https://doc.rust-lang.org/1.92.0/core/clone/trait.Clone.html" title="trait core::clone::Clone">Clone</a> + 'a,
    FReduce: <a class="trait" href="https://doc.rust-lang.org/1.92.0/core/ops/function/trait.Fn.html" title="trait core::ops::function::Fn">Fn</a>(S, K, StakeUnit, <a class="enum" href="https://doc.rust-lang.org/1.92.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;V, E&gt;) -&gt; BoxFuture&lt;'a, <a class="enum" href="enum.ReduceOutput.html" title="enum sui_authority_aggregation::ReduceOutput">ReduceOutput</a>&lt;R, S&gt;&gt; + 'a,</div></code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This function takes an initial state, than executes an asynchronous function (FMap) for each
authority, and folds the results as they become available into the state using an async function (FReduce).</p>
<p>FMap can do io, and returns a result V. An error there may not be fatal, and could be consumed by the
MReduce function to overall recover from it. This is necessary to ensure byzantine authorities cannot
interrupt the logic of this function.</p>
<p>FReduce returns a result to a ReduceOutput. If the result is Err the function
shortcuts and the Err is returned. An Ok ReduceOutput result can be used to shortcut and return
the resulting state (ReduceOutput::End), continue the folding as new states arrive (ReduceOutput::Continue).</p>
<p>This function provides a flexible way to communicate with a quorum of authorities, processing and
processing their results into a safe overall result, and also safely allowing operations to continue
past the quorum to ensure all authorities are up to date (up to a timeout).</p>
</div></details></section></div></main></body></html>